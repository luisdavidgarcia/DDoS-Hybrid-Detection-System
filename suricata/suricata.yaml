%YAML 1.1
---

# Suricata Configuration File for DDoS Testbed

# General configuration
vars:
  # Define home net to be the internal subnet (adjusted to 172.19.5.0/24)
  address-groups:
    HOME_NET: "[172.19.5.0/24]"
    EXTERNAL_NET: "$HOME_NET"

default-log-dir: /var/log/suricata  # Where the logs will be stored

# Capture interface - using AF_PACKET for live capture
af-packet:
  - interface: eth0
    use-ipv4: yes          # Ensure IPv4 is used
    use-ipv6: no           # Disable IPv6
    cluster-type: cluster_flow
    cluster-id: 99
    defrag: yes
    use-mmap: yes

# Logging Configuration for Suricata's internal logs
logging:
  default-log-level: info
  outputs:
    - file:
        enabled: yes
        filename: /var/log/suricata/suricata.log
        append: yes

# Outputs Configuration for event logs (e.g., eve.json)
outputs:
  - eve-log:
      enabled: yes
      filetype: regular
      filename: /var/log/suricata/eve.json
      community-id: yes
      types:
        - alert:
            metadata: yes
            tags: yes
            flow: yes
        - http:
            extended: yes
        - dns:
            query: yes
        - tls:
            extended: yes
        - drop
        - fileinfo
        - ssh
        - stats:
            totals: yes
            threads: yes
        - flow

# Alerting based on Suricata's default rules
rule-files:
  - /etc/suricata/rules/suricata.rules

# CPU configuration
threading:
  set-cpu-affinity: yes
  cpu-affinity:
    - management-cpu-set:
        cpu: [ 0 ]  # Use core 0 for management threads

    - receive-cpu-set:
        cpu: [ "all" ]  # Use all available CPUs for packet threads

  detect-thread-ratio: 1.0

# Threshold configuration to avoid overwhelming logs
threshold:
  limit: 50
  track: by_src
  type: limit

# Performance tuning for packet processing
detect-engine:
  - profile: high
    custom-values:
      max-pending-packets: 10000
      prealloc-packets: 10000